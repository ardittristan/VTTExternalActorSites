{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/dnd5e/populatesheet.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","filters","inventory","Set","spellbook","features","_tabs","navSelector","contentSelector","initial","map","Tabs","getProficiencyIcon","level","0","0.5","1","2","isObjectEmpty","obj","token","tof","cn","constructor","includes","test","getType","Error","keys","length","getProperty","target","split","filterItems","items","filter","item","data","f","has","activation","type","components","ritual","concentration","preparation","this","actor","prepared","equipped","Array","fromRange","from","parseInt","Hooks","on","sheetTemplate","actorData","baseUrl","img","sort","a","b","abl","entries","abilities","icon","proficient","hover","dnd5e","proficiencyLevels","label","skl","skills","ability","substring","hp","attributes","temp","tempmax","resources","reduce","arr","res","placeholder","toString","max","concat","traits","dr","damageTypes","di","dv","ci","conditionTypes","languages","armorProf","armorProficiencies","weaponProf","weaponProficiencies","toolProf","toolProficiencies","choices","trait","values","selected","custom","forEach","trim","cssClass","prepareTraits","getData","weapon","dataset","equipment","consumable","tool","backpack","loot","spells","feats","classes","labels","flags","externalactor","isStack","quantity","hasUses","uses","isOnCooldown","recharge","charged","isDepleted","per","hasTarget","isAlways","isPrepared","toggleClass","toggleTitle","spellPreparationModes","always","isActive","prepareItemToggleState","push","levels","sections","atwill","innate","pact","useLabels","registerSection","sl","order","usesSlots","canCreate","canPrepare","slots","override","prop","maxLevel","spellLevels","lvl","spell","sorted","prepareSpellbook","nPrepared","totalWeight","weight","Math","round","encumbrance","mod","tiny","sm","med","lg","huge","grg","size","powerfulBuild","min","currencyWeight","currency","val","denom","currencyPerWeight","enc","str","strMultiplier","pct","encumbered","computeEncumbrance","hasActions","isClass","active","passive","preparedSpells","prepareItems","$","innerHTML","disableExperience","classLabels","isCharacter","isNPC","owner","actorSizes","allowedProtoProperties","html","first","find","each","el","classList","remove","activateListeners"],"mappings":"aACE,IAAIA,EAAmB,GAGvB,SAASC,EAAoBC,GAG5B,GAAGF,EAAiBE,GACnB,OAAOF,EAAiBE,GAAUC,QAGnC,IAAIC,EAASJ,EAAiBE,GAAY,CACzCG,EAAGH,EACHI,GAAG,EACHH,QAAS,IAUV,OANAI,EAAQL,GAAUM,KAAKJ,EAAOD,QAASC,EAAQA,EAAOD,QAASF,GAG/DG,EAAOE,GAAI,EAGJF,EAAOD,QAKfF,EAAoBQ,EAAIF,EAGxBN,EAAoBS,EAAIV,EAGxBC,EAAoBU,EAAI,SAASR,EAASS,EAAMC,GAC3CZ,EAAoBa,EAAEX,EAASS,IAClCG,OAAOC,eAAeb,EAASS,EAAM,CAAEK,YAAY,EAAMC,IAAKL,KAKhEZ,EAAoBkB,EAAI,SAAShB,GACX,oBAAXiB,QAA0BA,OAAOC,aAC1CN,OAAOC,eAAeb,EAASiB,OAAOC,YAAa,CAAEC,MAAO,WAE7DP,OAAOC,eAAeb,EAAS,aAAc,CAAEmB,OAAO,KAQvDrB,EAAoBsB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQrB,EAAoBqB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,iBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKX,OAAOY,OAAO,MAGvB,GAFA1B,EAAoBkB,EAAEO,GACtBX,OAAOC,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOrB,EAAoBU,EAAEe,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRzB,EAAoB6B,EAAI,SAAS1B,GAChC,IAAIS,EAAST,GAAUA,EAAOqB,WAC7B,WAAwB,OAAOrB,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAH,EAAoBU,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRZ,EAAoBa,EAAI,SAASiB,EAAQC,GAAY,OAAOjB,OAAOkB,UAAUC,eAAe1B,KAAKuB,EAAQC,IAGzG/B,EAAoBkC,EAAI,GAIjBlC,EAAoBA,EAAoBmC,EAAI,K,oBClFrD,MAAMC,EAAU,CACdC,UAAW,IAAIC,IACfC,UAAW,IAAID,IACfE,SAAU,IAAIF,KAWVG,EARO,CACX,CACEC,YAAa,QACbC,gBAAiB,cACjBC,QAAS,gBA+XCC,KAAKvB,GACR,IAAIwB,KAAKxB,KAxCpB,SAASyB,EAAmBC,GAO1B,MANc,CACZC,EAAG,gCACHC,GAAK,gCACLC,EAAG,+BACHC,EAAG,uCAEQJ,GAUf,SAASK,EAAcC,GACrB,GAAqB,WAMvB,SAAiBC,GACf,MAAMC,SAAaD,EACnB,GAAY,WAARC,EAAkB,CACpB,GAAc,OAAVD,EAAgB,MAAO,OAC3B,IAAIE,EAAKF,EAAMG,YAAY/C,KAC3B,MAAI,CAAC,SAAU,SAAU,UAAW,QAAS,OAAOgD,SAASF,GAAYA,EAChE,QAAQG,KAAKH,GAAY,cACtB,SAEd,OAAOD,EAfHK,CAAQP,GAAmB,MAAM,IAAIQ,MAAM,uCAC/C,OAAmC,IAA5BhD,OAAOiD,KAAKT,GAAKU,OAmC1B,SAASC,EAAYnC,EAAQH,GAC3B,IAAKA,EAAK,OACV,IAAIuC,EAASpC,EACb,IAAK,IAAII,KAAKP,EAAIwC,MAAM,KAAM,CAE5B,GADAD,EAASA,GAAU,KACfhC,KAAKgC,GACJ,OADYA,EAASA,EAAOhC,GAGnC,OAAOgC,EAUT,SAASE,EAAYC,EAAOjC,GAC1B,OAAOiC,EAAMC,QAAQC,IACnB,MAAMC,EAAOD,EAAKC,KAGlB,IAAK,IAAIC,IAAK,CAAC,SAAU,QAAS,YAChC,GAAIrC,EAAQsC,IAAID,IACVD,EAAKG,YAAcH,EAAKG,WAAWC,OAASH,EAAG,OAAO,EAK9D,QAAIrC,EAAQsC,IAAI,YACiB,IAA3BF,EAAKK,WAAWC,YAElB1C,EAAQsC,IAAI,mBACwB,IAAlCF,EAAKK,WAAWE,iBAElB3C,EAAQsC,IAAI,cACK,IAAfF,EAAKxB,QAAe,CAAC,SAAU,UAAUW,SAASa,EAAKQ,YAAYzD,SAC1C,QAAzB0D,KAAKC,MAAMV,KAAKI,MACbJ,EAAKQ,YAAYG,WAItB/C,EAAQsC,IAAI,cACQ,IAAlBF,EAAKY,cAqDfC,MAAMC,UAAY,SAAUzD,GAC1B,OAAOwD,MAAME,KAAK,IAAIF,MAAMG,SAAS3D,IAAIkC,SAG3C0B,MAAMC,GAAG,aApeT,SAAuBC,EAAeC,EAAWC,GAAS,YACxD,MAAMrB,EAwCR,SAAiBoB,EAAWC,GAC1BD,EAAUE,IAAMD,EAAUD,EAAUE,IAEpC,IAAIzB,EAAQuB,EAAUvB,MAEtBA,EAAM0B,MAAK,CAACC,EAAGC,KAAOD,EAAED,MAAQ,IAAME,EAAEF,MAAQ,KAGhD,IAAK,IAAKC,EAAGE,KAAQpF,OAAOqF,QAAQP,EAAUpB,KAAK4B,WACjDF,EAAIG,KAAOtD,EAAmBmD,EAAII,YAClCJ,EAAIK,MAAQC,MAAMC,kBAAkBP,EAAII,YACxCJ,EAAIQ,MAAQF,MAAMJ,UAAUJ,GAI9B,IAAK,IAAK7D,EAAGwE,KAAQ7F,OAAOqF,QAAQP,EAAUpB,KAAKoC,QACjDD,EAAIE,QAAUjB,EAAUpB,KAAK4B,UAAUO,EAAIE,SAASH,MAAMI,UAAU,EAAG,GACvEH,EAAIN,KAAOtD,EAAmB4D,EAAItF,OAClCsF,EAAIJ,MAAQC,MAAMC,kBAAkBE,EAAItF,OACxCsF,EAAID,MAAQF,MAAMI,OAAOzE,GAI3B,IAAI4E,EAAKnB,EAAUpB,KAAKwC,WAAWD,GACnB,IAAZA,EAAGE,aAAmBF,EAAGE,KACV,IAAfF,EAAGG,gBAAsBH,EAAGG,QAGhC,MAAMC,EAAY,CAAC,UAAW,YAAa,YAAYC,QAAO,CAACC,EAAKnG,EAAGd,KACrE,MAAMkH,EAAM1B,EAAUpB,KAAK2C,UAAUjG,IAAM,GAK3C,OAJAoG,EAAI3G,KAAOO,EACXoG,EAAIC,YAAe,aAAYnH,EAAI,GAAGoH,aAClCF,GAAqB,IAAdA,EAAIjG,cAAoBiG,EAAIjG,MACnCiG,GAAmB,IAAZA,EAAIG,YAAkBH,EAAIG,IAC9BJ,EAAIK,OAAO,CAACJ,MAClB,IAKH,OAqBF,SAAuBK,GACrB,MAAM9E,EAAM,CACV+E,GAAIpB,MAAMqB,YACVC,GAAItB,MAAMqB,YACVE,GAAIvB,MAAMqB,YACVG,GAAIxB,MAAMyB,eACVC,UAAW1B,MAAM0B,UACjBC,UAAW3B,MAAM4B,mBACjBC,WAAY7B,MAAM8B,oBAClBC,SAAU/B,MAAMgC,mBAElB,IAAK,IAAKlH,EAAGmH,KAAY3H,OAAOqF,QAAQtD,GAAM,CAC5C,MAAM6F,EAAQf,EAAOrG,GACrB,IAAKoH,EAAO,SACZ,IAAIC,EAAS,GACTD,EAAMrH,QACRsH,EAASD,EAAMrH,iBAAiBgE,MAAQqD,EAAMrH,MAAQ,CAACqH,EAAMrH,QAE/DqH,EAAME,SAAWD,EAAOvB,QAAO,CAAC9D,EAAKhC,KACnCgC,EAAIhC,GAAKmH,EAAQnH,GACVgC,IACN,IAGCoF,EAAMG,QACRH,EAAMG,OAAO1E,MAAM,KAAK2E,SAAQ,CAACrI,EAAGL,IAAOsI,EAAME,SAAU,SAAQxI,EAAI,KAAOK,EAAEsI,SAElFL,EAAMM,SAAY3F,EAAcqF,EAAME,UAAiB,WAAL,IAlDpDK,CAAcrD,EAAUpB,KAAKmD,QAEtB,CACL/B,YACAuB,YACA9C,SAnFW6E,CAAQtD,EAAWC,IAsIlC,SAAsBrB,EAAMqB,GAE1B,MAAMxD,EAAY,CAChB8G,OAAQ,CAAEzC,MAAO,UAAWrC,MAAO,GAAI+E,QAAS,CAAExE,KAAM,WACxDyE,UAAW,CAAE3C,MAAO,YAAarC,MAAO,GAAI+E,QAAS,CAAExE,KAAM,cAC7D0E,WAAY,CAAE5C,MAAO,cAAerC,MAAO,GAAI+E,QAAS,CAAExE,KAAM,eAChE2E,KAAM,CAAE7C,MAAO,QAASrC,MAAO,GAAI+E,QAAS,CAAExE,KAAM,SACpD4E,SAAU,CAAE9C,MAAO,aAAcrC,MAAO,GAAI+E,QAAS,CAAExE,KAAM,aAC7D6E,KAAM,CAAE/C,MAAO,OAAQrC,MAAO,GAAI+E,QAAS,CAAExE,KAAM,UAIrD,IAAKP,EAAOqF,EAAQC,EAAOC,GAAWpF,EAAKH,MAAM+C,QAC/C,CAACC,EAAK9C,KAAS,QAqBb,OApBAA,EAAKsF,OAAL,UAActF,EAAKuF,aAAnB,iBAAc,EAAYC,qBAA1B,aAAc,EAA2BF,OAGzCtF,EAAKuB,IAAMD,EAAUtB,EAAKuB,KAAOD,EAAU,4BAC3CtB,EAAKyF,UAAUzF,EAAKC,KAAKyF,UAAW1F,EAAKC,KAAKyF,SAAW,EAGzD1F,EAAK2F,QAAU3F,EAAKC,KAAK2F,MAAQ5F,EAAKC,KAAK2F,KAAK1C,IAAM,EACtDlD,EAAK6F,aAAe7F,EAAKC,KAAK6F,YAAc9F,EAAKC,KAAK6F,SAAShJ,QAAwC,IAA/BkD,EAAKC,KAAK6F,SAASC,QAC3F/F,EAAKgG,WAAahG,EAAK6F,cAAgB7F,EAAKC,KAAK2F,KAAKK,KAAOjG,EAAKC,KAAK2F,KAAK9I,MAAQ,EACpFkD,EAAKkG,YAAclG,EAAKC,KAAKN,SAAW,CAAC,OAAQ,IAAIP,SAASY,EAAKC,KAAKN,OAAOU,MAwJrF,SAAgCL,GAC9B,GAAkB,UAAdA,EAAKK,KAAkB,CACzB,MAAM8F,EAA0D,WAA/CzG,EAAYM,EAAKC,KAAM,oBAClCmG,EAAa1G,EAAYM,EAAKC,KAAM,wBAC1CD,EAAKqG,YAAcD,EAAa,SAAW,GACvCD,IAAUnG,EAAKqG,YAAc,SACnBrG,EAAKsG,YAAfH,EAA6BlE,MAAMsE,sBAAsBC,OACpDJ,EAA+BnE,MAAMsE,sBAAsB3F,SAC5C,iBACnB,CACL,MAAM6F,EAAW/G,EAAYM,EAAKC,KAAM,YACxCD,EAAKqG,YAAcI,EAAW,SAAW,GACzCzG,EAAKsG,YAAcG,EAAW,WAAa,gBAjKzCC,CAAuB1G,GAGL,UAAdA,EAAKK,KAAkByC,EAAI,GAAG6D,KAAK3G,GAChB,SAAdA,EAAKK,KAAiByC,EAAI,GAAG6D,KAAK3G,GACpB,UAAdA,EAAKK,KAAkByC,EAAI,GAAG6D,KAAK3G,GACnCzD,OAAOiD,KAAK1B,GAAWsB,SAASY,EAAKK,OAAOyC,EAAI,GAAG6D,KAAK3G,GAC1D8C,IAET,CAAC,GAAI,GAAI,GAAI,KAIfhD,EAAQD,EAAYC,EAAOjC,EAAQC,WACnCqH,EAAStF,EAAYsF,EAAQtH,EAAQG,WACrCoH,EAAQvF,EAAYuF,EAAOvH,EAAQI,UAGnC,MAAMD,EA4CR,SAA0BiC,EAAMkF,GAC9B,MAAMyB,EAAS3G,EAAKoB,UAAUpB,KAAKkF,OAC7BnH,EAAY,GAGZ6I,EAAW,CACfC,QAAS,GACTC,QAAS,GACTC,KAAM,IAIFC,EAAY,CAChB,MAAO,IACP,MAAO,IACPvI,EAAG,WAICwI,EAAkB,CAACC,EAAItL,EAAGsG,EAAO1D,EAAQ,MAC7CT,EAAUnC,GAAK,CACbuL,MAAOvL,EACPsG,MAAOA,EACPkF,UAAWxL,EAAI,EACfyL,UAAWzL,GAAK,EAChB0L,WAAY1L,GAAK,EACjBsJ,OAAQ,GACRS,KAAMqB,EAAUpL,IAAM4C,EAAM3B,OAAS,EACrC0K,MAAOP,EAAUpL,IAAM4C,EAAMyE,KAAO,EACpCuE,SAAUhJ,EAAMgJ,UAAY,EAC5B5C,QAAS,CAAExE,KAAM,QAAS5B,MAAO5C,GACjC6L,KAAMP,IAKJQ,EAAW7G,MAAMC,UAAU,IAAI8B,QAAO,CAACK,EAAKrH,KAChD,GAAU,IAANA,EAAS,OAAOqH,EACpB,MAAMzE,EAAQmI,EAAQ,QAAO/K,KAE7B,OADK4C,EAAMyE,KAAOzE,EAAMgJ,WAAa5L,EAAIqH,IAAKA,EAAMrH,GAC7CqH,IACN,GAGH,GAAIyE,EAAW,EAAG,CAChBT,EAAgB,SAAU,EAAGjF,MAAM2F,YAAY,IAC/C,IAAK,IAAIC,EAAM,EAAGA,GAAOF,EAAUE,IAAO,CACxC,MAAMV,EAAM,QAAOU,IACnBX,EAAgBC,EAAIU,EAAK5F,MAAM2F,YAAYC,GAAMjB,EAAOO,KAGxDP,EAAOI,MAAQJ,EAAOI,KAAK9D,MAC7BgE,EAAgB,SAAU,EAAGjF,MAAM2F,YAAY,IAC/CV,EAAgB,OAAQL,EAASG,KAAM/E,MAAMsE,sBAAsBS,KAAMJ,EAAOI,OAIlF7B,EAAOZ,SAASuD,IACd,MAAM9K,EAAO8K,EAAM7H,KAAKQ,YAAYzD,MAAQ,WAC5C,IAAIY,EAAIkK,EAAM7H,KAAKxB,OAAS,EAC5B,MAAM0I,EAAM,QAAOvJ,IAGfZ,KAAQ6J,GACVjJ,EAAIiJ,EAAS7J,GACRgB,EAAUJ,IACbsJ,EAAgBlK,EAAMY,EAAGqE,MAAMsE,sBAAsBvJ,GAAO4J,EAAO5J,KAK7DgB,EAAUJ,IAClBsJ,EAAgBC,EAAIvJ,EAAGqE,MAAM2F,YAAYhK,GAAIgJ,EAAOO,IAItDnJ,EAAUJ,GAAGuH,OAAOwB,KAAKmB,MAI3B,MAAMC,EAASxL,OAAO6H,OAAOpG,GAE7B,OADA+J,EAAOvG,MAAK,CAACC,EAAGC,IAAMD,EAAE2F,MAAQ1F,EAAE0F,QAC3BW,EA9HWC,CAAiB/H,EAAMkF,GACnC8C,EAAY9C,EAAOpF,QAAQnC,GACxBA,EAAEqC,KAAKxB,MAAQ,GAAiC,aAA5Bb,EAAEqC,KAAKQ,YAAYzD,MAAuBY,EAAEqC,KAAKQ,YAAYG,WACvFnB,OAGH,IAAIyI,EAAc,EAClB,IAAK,IAAIrM,KAAKiE,EACZjE,EAAEoE,KAAKyF,SAAW7J,EAAEoE,KAAKyF,UAAY,EACrC7J,EAAEoE,KAAKkI,OAAStM,EAAEoE,KAAKkI,QAAU,EACjCtM,EAAEqM,YAAcE,KAAKC,MAAMxM,EAAEoE,KAAKyF,SAAW7J,EAAEoE,KAAKkI,OAAS,IAAM,GACnErK,EAAUjC,EAAEwE,MAAMP,MAAM6G,KAAK9K,GAC7BqM,GAAerM,EAAEqM,YAEnBjI,EAAKoB,UAAUpB,KAAKwC,WAAW6F,YA4PjC,SAA4BJ,EAAajI,GAAM,YAE7C,IAAIsI,EACF,CACEC,KAAM,GACNC,GAAI,EACJC,IAAK,EACLC,GAAI,EACJC,KAAM,EACNC,IAAK,GACL5I,EAAKoB,UAAUpB,KAAKmD,OAAO0F,OAAS,EAGxC,UAAI7I,EAAKoB,UAAUpB,KAAKsF,aAAxB,iBAAI,EAA2BtD,aAA/B,OAAI,EAAkC8G,gBAAeR,EAAMH,KAAKY,IAAU,EAANT,EAAS,IAG7E,aAAItI,EAAKoB,UAAUpB,KAAKsF,aAAxB,iBAAI,EAA2BC,qBAA/B,OAAI,EAA0CyD,eAAgB,CAC5D,MAAMC,EAAWjJ,EAAKoB,UAAUpB,KAAKiJ,SAErChB,GADiB3L,OAAO6H,OAAO8E,GAAUrG,QAAO,CAACsG,EAAKC,IAAWD,EAAOC,GAAQ,GACtDnH,MAAMqG,YAAYe,kBAI9C,MAAMC,EAAM,CACVpG,IAAKjD,EAAKoB,UAAUpB,KAAK4B,UAAU0H,IAAIzM,MAAQmF,MAAMqG,YAAYkB,cAAgBjB,EACjFzL,MAAOsL,KAAKC,MAAoB,GAAdH,GAAoB,IAIxC,OAFAoB,EAAIG,IAAMrB,KAAKY,IAAiB,IAAZM,EAAIxM,MAAewM,EAAIpG,IAAK,IAChDoG,EAAII,WAAaJ,EAAIG,IAAM,EAAI,EACxBH,EAzRsCK,CAAmBzB,EAAajI,GAG7E,MAAMhC,EAAW,CACfoH,QAAS,CAAElD,MAAO,eAAgBrC,MAAO,GAAI8J,YAAY,EAAO/E,QAAS,CAAExE,KAAM,SAAWwJ,SAAS,GACrGC,OAAQ,CAAE3H,MAAO,mBAAoBrC,MAAO,GAAI8J,YAAY,EAAM/E,QAAS,CAAExE,KAAM,OAAQ,kBAAmB,WAC9G0J,QAAS,CAAE5H,MAAO,oBAAqBrC,MAAO,GAAI8J,YAAY,EAAO/E,QAAS,CAAExE,KAAM,UAExF,IAAK,IAAIH,KAAKkF,EACRlF,EAAED,KAAKG,WAAWC,KAAMpC,EAAS6L,OAAOhK,MAAM6G,KAAKzG,GAClDjC,EAAS8L,QAAQjK,MAAM6G,KAAKzG,GAEnCmF,EAAQ7D,MAAK,CAACC,EAAGC,IAAMA,EAAEkF,OAASnF,EAAEmF,SACpC3I,EAASoH,QAAQvF,MAAQuF,EAGzBpF,EAAKnC,UAAYvB,OAAO6H,OAAOtG,GAC/BmC,EAAKjC,UAAYA,EACjBiC,EAAK+J,eAAiB/B,EACtBhI,EAAKhC,SAAW1B,OAAO6H,OAAOnG,GAlN9BgM,CAAahK,EAAMqB,GAInB4I,EAAE,mBAAmB,GAAGC,UAAY/I,EAClC,CACET,MAAOV,EAAKoB,UACZpB,KAAMA,EAAKoB,UAAUpB,KACrBH,MAAOG,EAAKoB,UAAUvB,MACtBsK,kBAAiB,UAAEnK,EAAKoB,UAAUkE,aAAjB,iBAAE,EAAsBC,qBAAxB,aAAE,EAAqC4E,kBACxDC,YAAW,UAAEpK,EAAKoB,UAAUkE,aAAjB,iBAAE,EAAsBC,qBAAxB,aAAE,EAAqC6E,YAClDxM,QAASA,EACT+E,UAAW3C,EAAK2C,UAChB0H,YAA0C,cAA7BrK,EAAKoB,UAAUpB,KAAKI,KACjCkK,MAAoC,QAA7BtK,EAAKoB,UAAUpB,KAAKI,KAC3BmK,OAAO,EACPC,WAAYxI,MAAMwI,WAClB3M,UAAWmC,EAAKnC,UAChBE,UAAWiC,EAAKjC,UAChBgM,eAAgB/J,EAAK+J,eACrB/L,SAAUgC,EAAKhC,UAEjB,CACEyM,uBAAwB,CACtB5B,MAAM,KA+Dd,WACE,MAAM6B,EAAOT,EAAE,mBAAmBU,QAElC1M,EAAMqG,SAASxH,GAAMA,EAAEM,KAAKsN,EAAK,MAEjCA,EAAKE,KAAK,aAAaC,MAAK,CAACjP,EAAGkP,IAAOA,EAAGC,UAAUC,OAAO,cA/D3DC","file":"populatesheet.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 365);\n","const filters = {\n  inventory: new Set(),\n  spellbook: new Set(),\n  features: new Set(),\n};\n\nconst tabs = [\n  {\n    navSelector: \".tabs\",\n    contentSelector: \".sheet-body\",\n    initial: \"description\",\n  },\n];\n\nconst _tabs = createTabHandlers();\n\n/* -------------------------------------------- */\n/*   Sheet Populator                            */\n/* -------------------------------------------- */\n\n/**\n * @param  {HandlebarsTemplatable} sheetTemplate\n * @param  {Object} actorData\n * @param  {String} baseUrl\n */\nfunction populateSheet(sheetTemplate, actorData, baseUrl) {\n  const data = getData(actorData, baseUrl);\n\n  prepareItems(data, baseUrl);\n\n  // config.currencies\n\n  $(\".window-content\")[0].innerHTML = sheetTemplate(\n    {\n      actor: data.actorData,\n      data: data.actorData.data,\n      items: data.actorData.items,\n      disableExperience: data.actorData.flags?.externalactor?.disableExperience,\n      classLabels: data.actorData.flags?.externalactor?.classLabels,\n      filters: filters,\n      resources: data.resources,\n      isCharacter: data.actorData.data.type === \"character\",\n      isNPC: data.actorData.data.type === \"npc\",\n      owner: true,\n      actorSizes: dnd5e.actorSizes,\n      inventory: data.inventory,\n      spellbook: data.spellbook,\n      preparedSpells: data.preparedSpells,\n      features: data.features,\n    },\n    {\n      allowedProtoProperties: {\n        size: true,\n      },\n    }\n  );\n\n  activateListeners();\n}\n\n/* -------------------------------------------- */\n\n/**\n * @param  {Object} actorData\n * @param  {String} baseUrl\n */\nfunction getData(actorData, baseUrl) {\n  actorData.img = baseUrl + actorData.img;\n\n  let items = actorData.items;\n\n  items.sort((a, b) => (a.sort || 0) - (b.sort || 0));\n\n  // Ability Scores\n  for (let [a, abl] of Object.entries(actorData.data.abilities)) {\n    abl.icon = getProficiencyIcon(abl.proficient);\n    abl.hover = dnd5e.proficiencyLevels[abl.proficient];\n    abl.label = dnd5e.abilities[a];\n  }\n\n  // Update skill labels\n  for (let [s, skl] of Object.entries(actorData.data.skills)) {\n    skl.ability = actorData.data.abilities[skl.ability].label.substring(0, 3);\n    skl.icon = getProficiencyIcon(skl.value);\n    skl.hover = dnd5e.proficiencyLevels[skl.value];\n    skl.label = dnd5e.skills[s];\n  }\n\n  // Temporary HP\n  let hp = actorData.data.attributes.hp;\n  if (hp.temp === 0) delete hp.temp;\n  if (hp.tempmax === 0) delete hp.tempmax;\n\n  // Resources\n  const resources = [\"primary\", \"secondary\", \"tertiary\"].reduce((arr, r, i) => {\n    const res = actorData.data.resources[r] || {};\n    res.name = r;\n    res.placeholder = `Resource ${(i + 1).toString()}`;\n    if (res && res.value === 0) delete res.value;\n    if (res && res.max === 0) delete res.max;\n    return arr.concat([res]);\n  }, []);\n\n  // Update traits\n  prepareTraits(actorData.data.traits);\n\n  return {\n    actorData,\n    resources,\n    items,\n  };\n}\n\n/* -------------------------------------------- */\n\nfunction activateListeners() {\n  const html = $(\".window-content\").first();\n\n  _tabs.forEach((t) => t.bind(html[0]));\n\n  html.find(\".rollable\").each((i, el) => el.classList.remove(\"rollable\"));\n}\n\n/* -------------------------------------------- */\n/*   Helper Functions                           */\n/* -------------------------------------------- */\n\nfunction prepareTraits(traits) {\n  const map = {\n    dr: dnd5e.damageTypes,\n    di: dnd5e.damageTypes,\n    dv: dnd5e.damageTypes,\n    ci: dnd5e.conditionTypes,\n    languages: dnd5e.languages,\n    armorProf: dnd5e.armorProficiencies,\n    weaponProf: dnd5e.weaponProficiencies,\n    toolProf: dnd5e.toolProficiencies,\n  };\n  for (let [t, choices] of Object.entries(map)) {\n    const trait = traits[t];\n    if (!trait) continue;\n    let values = [];\n    if (trait.value) {\n      values = trait.value instanceof Array ? trait.value : [trait.value];\n    }\n    trait.selected = values.reduce((obj, t) => {\n      obj[t] = choices[t];\n      return obj;\n    }, {});\n\n    // Add custom entry\n    if (trait.custom) {\n      trait.custom.split(\";\").forEach((c, i) => (trait.selected[`custom${i + 1}`] = c.trim()));\n    }\n    trait.cssClass = !isObjectEmpty(trait.selected) ? \"\" : \"inactive\";\n  }\n}\n\n/* -------------------------------------------- */\n\nfunction prepareItems(data, baseUrl) {\n  // Categorize items as inventory, spellbook, features, and classes\n  const inventory = {\n    weapon: { label: \"Weapons\", items: [], dataset: { type: \"weapon\" } },\n    equipment: { label: \"Equipment\", items: [], dataset: { type: \"equipment\" } },\n    consumable: { label: \"Consumables\", items: [], dataset: { type: \"consumable\" } },\n    tool: { label: \"Tools\", items: [], dataset: { type: \"tool\" } },\n    backpack: { label: \"Containers\", items: [], dataset: { type: \"backpack\" } },\n    loot: { label: \"Loot\", items: [], dataset: { type: \"loot\" } },\n  };\n\n  // Partition items by category\n  let [items, spells, feats, classes] = data.items.reduce(\n    (arr, item) => {\n      item.labels = item.flags?.externalactor?.labels;\n\n      // Item details\n      item.img = baseUrl + item.img || baseUrl + \"icons/svg/mystery-man.svg\";\n      item.isStack = item.data.quantity ? item.data.quantity > 1 : false;\n\n      // Item usage\n      item.hasUses = item.data.uses && item.data.uses.max > 0;\n      item.isOnCooldown = item.data.recharge && !!item.data.recharge.value && item.data.recharge.charged === false;\n      item.isDepleted = item.isOnCooldown && item.data.uses.per && item.data.uses.value > 0;\n      item.hasTarget = !!item.data.target && ![\"none\", \"\"].includes(item.data.target.type);\n\n      // Item toggle state\n      prepareItemToggleState(item);\n\n      // Classify items into types\n      if (item.type === \"spell\") arr[1].push(item);\n      else if (item.type === \"feat\") arr[2].push(item);\n      else if (item.type === \"class\") arr[3].push(item);\n      else if (Object.keys(inventory).includes(item.type)) arr[0].push(item);\n      return arr;\n    },\n    [[], [], [], []]\n  );\n\n  // Apply active item filters\n  items = filterItems(items, filters.inventory);\n  spells = filterItems(spells, filters.spellbook);\n  feats = filterItems(feats, filters.features);\n\n  // Organize Spellbook and count the number of prepared spells (excluding always, at will, etc...)\n  const spellbook = prepareSpellbook(data, spells);\n  const nPrepared = spells.filter((s) => {\n    return s.data.level > 0 && s.data.preparation.mode === \"prepared\" && s.data.preparation.prepared;\n  }).length;\n\n  // Organize Inventory\n  let totalWeight = 0;\n  for (let i of items) {\n    i.data.quantity = i.data.quantity || 0;\n    i.data.weight = i.data.weight || 0;\n    i.totalWeight = Math.round(i.data.quantity * i.data.weight * 10) / 10;\n    inventory[i.type].items.push(i);\n    totalWeight += i.totalWeight;\n  }\n  data.actorData.data.attributes.encumbrance = computeEncumbrance(totalWeight, data);\n\n  // Organize Features\n  const features = {\n    classes: { label: \"Class Levels\", items: [], hasActions: false, dataset: { type: \"class\" }, isClass: true },\n    active: { label: \"Active Abilities\", items: [], hasActions: true, dataset: { type: \"feat\", \"activation.type\": \"action\" } },\n    passive: { label: \"Passive Abilities\", items: [], hasActions: false, dataset: { type: \"feat\" } },\n  };\n  for (let f of feats) {\n    if (f.data.activation.type) features.active.items.push(f);\n    else features.passive.items.push(f);\n  }\n  classes.sort((a, b) => b.levels - a.levels);\n  features.classes.items = classes;\n\n  // Assign and return\n  data.inventory = Object.values(inventory);\n  data.spellbook = spellbook;\n  data.preparedSpells = nPrepared;\n  data.features = Object.values(features);\n}\n\n/* -------------------------------------------- */\n\n/**\n * Insert a spell into the spellbook object when rendering the character sheet\n * @param {Object} data     The Actor data being prepared\n * @param {Array} spells    The spell data being prepared\n * @private\n */\nfunction prepareSpellbook(data, spells) {\n  const levels = data.actorData.data.spells;\n  const spellbook = {};\n\n  // Define some mappings\n  const sections = {\n    atwill: -20,\n    innate: -10,\n    pact: 0.5,\n  };\n\n  // Label spell slot uses headers\n  const useLabels = {\n    \"-20\": \"-\",\n    \"-10\": \"-\",\n    0: \"&infin;\",\n  };\n\n  // Format a spellbook entry for a certain indexed level\n  const registerSection = (sl, i, label, level = {}) => {\n    spellbook[i] = {\n      order: i,\n      label: label,\n      usesSlots: i > 0,\n      canCreate: i >= 1,\n      canPrepare: i >= 1,\n      spells: [],\n      uses: useLabels[i] || level.value || 0,\n      slots: useLabels[i] || level.max || 0,\n      override: level.override || 0,\n      dataset: { type: \"spell\", level: i },\n      prop: sl,\n    };\n  };\n\n  // Determine the maximum spell level which has a slot\n  const maxLevel = Array.fromRange(10).reduce((max, i) => {\n    if (i === 0) return max;\n    const level = levels[`spell${i}`];\n    if ((level.max || level.override) && i > max) max = i;\n    return max;\n  }, 0);\n\n  // Structure the spellbook for every level up to the maximum which has a slot\n  if (maxLevel > 0) {\n    registerSection(\"spell0\", 0, dnd5e.spellLevels[0]);\n    for (let lvl = 1; lvl <= maxLevel; lvl++) {\n      const sl = `spell${lvl}`;\n      registerSection(sl, lvl, dnd5e.spellLevels[lvl], levels[sl]);\n    }\n  }\n  if (levels.pact && levels.pact.max) {\n    registerSection(\"spell0\", 0, dnd5e.spellLevels[0]);\n    registerSection(\"pact\", sections.pact, dnd5e.spellPreparationModes.pact, levels.pact);\n  }\n\n  // Iterate over every spell item, adding spells to the spellbook by section\n  spells.forEach((spell) => {\n    const mode = spell.data.preparation.mode || \"prepared\";\n    let s = spell.data.level || 0;\n    const sl = `spell${s}`;\n\n    // Spellcasting mode specific headings\n    if (mode in sections) {\n      s = sections[mode];\n      if (!spellbook[s]) {\n        registerSection(mode, s, dnd5e.spellPreparationModes[mode], levels[mode]);\n      }\n    }\n\n    // Higher-level spell headings\n    else if (!spellbook[s]) {\n      registerSection(sl, s, dnd5e.spellLevels[s], levels[sl]);\n    }\n\n    // Add the spell to the relevant heading\n    spellbook[s].spells.push(spell);\n  });\n\n  // Sort the spellbook by section level\n  const sorted = Object.values(spellbook);\n  sorted.sort((a, b) => a.order - b.order);\n  return sorted;\n}\n\n/* -------------------------------------------- */\n\nfunction prepareItemToggleState(item) {\n  if (item.type === \"spell\") {\n    const isAlways = getProperty(item.data, \"preparation.mode\") === \"always\";\n    const isPrepared = getProperty(item.data, \"preparation.prepared\");\n    item.toggleClass = isPrepared ? \"active\" : \"\";\n    if (isAlways) item.toggleClass = \"fixed\";\n    if (isAlways) item.toggleTitle = dnd5e.spellPreparationModes.always;\n    else if (isPrepared) item.toggleTitle = dnd5e.spellPreparationModes.prepared;\n    else item.toggleTitle = \"Unprepared\";\n  } else {\n    const isActive = getProperty(item.data, \"equipped\");\n    item.toggleClass = isActive ? \"active\" : \"\";\n    item.toggleTitle = isActive ? \"Equipped\" : \"Not Equipped\";\n  }\n}\n\n/* -------------------------------------------- */\n\nfunction getProficiencyIcon(level) {\n  const icons = {\n    0: '<i class=\"far fa-circle\"></i>',\n    0.5: '<i class=\"fas fa-adjust\"></i>',\n    1: '<i class=\"fas fa-check\"></i>',\n    2: '<i class=\"fas fa-check-double\"></i>',\n  };\n  return icons[level];\n}\n\n/* -------------------------------------------- */\n\n/**\n * A simple function to test whether or not an Object is empty\n * @param {Object} obj    The object to test\n * @return {Boolean}      Is the object empty?\n */\nfunction isObjectEmpty(obj) {\n  if (getType(obj) !== \"Object\") throw new Error(\"The provided data is not an object!\");\n  return Object.keys(obj).length === 0;\n}\n\n/* -------------------------------------------- */\n\nfunction getType(token) {\n  const tof = typeof token;\n  if (tof === \"object\") {\n    if (token === null) return \"null\";\n    let cn = token.constructor.name;\n    if ([\"String\", \"Number\", \"Boolean\", \"Array\", \"Set\"].includes(cn)) return cn;\n    else if (/^HTML/.test(cn)) return \"HTMLElement\";\n    else return \"Object\";\n  }\n  return tof;\n}\n\n/* -------------------------------------------- */\n\nfunction createTabHandlers() {\n  return tabs.map((t) => {\n    return new Tabs(t);\n  });\n}\n\n/* -------------------------------------------- */\n\n/**\n * A helper function which searches through an object to retrieve a value by a string key.\n * The string key supports the notation a.b.c which would return object[a][b][c]\n * @param object {Object}   The object to traverse\n * @param key {String}      An object property with notation a.b.c\n *\n * @return {*}              The value of the found property\n */\nfunction getProperty(object, key) {\n  if (!key) return undefined;\n  let target = object;\n  for (let p of key.split(\".\")) {\n    target = target || {};\n    if (p in target) target = target[p];\n    else return undefined;\n  }\n  return target;\n}\n\n/* -------------------------------------------- */\n\n/**\n * Determine whether an Owned Item will be shown based on the current set of filters\n * @return {boolean}\n * @private\n */\nfunction filterItems(items, filters) {\n  return items.filter((item) => {\n    const data = item.data;\n\n    // Action usage\n    for (let f of [\"action\", \"bonus\", \"reaction\"]) {\n      if (filters.has(f)) {\n        if (data.activation && data.activation.type !== f) return false;\n      }\n    }\n\n    // Spell-specific filters\n    if (filters.has(\"ritual\")) {\n      if (data.components.ritual !== true) return false;\n    }\n    if (filters.has(\"concentration\")) {\n      if (data.components.concentration !== true) return false;\n    }\n    if (filters.has(\"prepared\")) {\n      if (data.level === 0 || [\"innate\", \"always\"].includes(data.preparation.mode)) return true;\n      if (this.actor.data.type === \"npc\") return true;\n      return data.preparation.prepared;\n    }\n\n    // Equipment-specific filters\n    if (filters.has(\"equipped\")) {\n      if (data.equipped !== true) return false;\n    }\n    return true;\n  });\n}\n\n/* -------------------------------------------- */\n\n/**\n * Compute the level and percentage of encumbrance for an Actor.\n *\n * Optionally include the weight of carried currency across all denominations by applying the standard rule\n * from the PHB pg. 143\n *\n * @param {Number} totalWeight    The cumulative item weight from inventory items\n * @param {Object} actorData      The data object for the Actor being rendered\n * @return {Object}               An object describing the character's encumbrance level\n * @private\n */\nfunction computeEncumbrance(totalWeight, data) {\n  // Encumbrance classes\n  let mod =\n    {\n      tiny: 0.5,\n      sm: 1,\n      med: 1,\n      lg: 2,\n      huge: 4,\n      grg: 8,\n    }[data.actorData.data.traits.size] || 1;\n\n  // Apply Powerful Build feat\n  if (data.actorData.data.flags?.dnd5e?.powerfulBuild) mod = Math.min(mod * 2, 8);\n\n  // Add Currency Weight\n  if (data.actorData.data.flags?.externalactor?.currencyWeight) {\n    const currency = data.actorData.data.currency;\n    const numCoins = Object.values(currency).reduce((val, denom) => (val += denom), 0);\n    totalWeight += numCoins / dnd5e.encumbrance.currencyPerWeight;\n  }\n\n  // Compute Encumbrance percentage\n  const enc = {\n    max: data.actorData.data.abilities.str.value * dnd5e.encumbrance.strMultiplier * mod,\n    value: Math.round(totalWeight * 10) / 10,\n  };\n  enc.pct = Math.min((enc.value * 100) / enc.max, 99);\n  enc.encumbered = enc.pct > 2 / 3;\n  return enc;\n}\n\n/* -------------------------------------------- */\n\nArray.fromRange = function (n) {\n  return Array.from(new Array(parseInt(n)).keys());\n};\n\nHooks.on(\"showSheet\", populateSheet);\n"],"sourceRoot":""}